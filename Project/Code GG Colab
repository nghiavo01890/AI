#
from google.colab import drive
drive.mount('/content/drive')

#
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import os
import keras
import tensorflow as tf

#
from keras.models import Sequential
from keras.layers import Dense
from keras.callbacks import ModelCheckpoint
from keras import datasets,Sequential,callbacks
from keras.layers import Conv2D, Dense, MaxPooling2D, Flatten
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from keras.layers import Dense,Activation,BatchNormalization,Dropout
from keras.models import Sequential
from tensorflow.keras.utils import to_categorical
from keras import callbacks
from sklearn.metrics import precision_score, recall_score,confusion_matrix,classification_report,accuracy_score,f1_score
from keras.callbacks import EarlyStopping
from tensorflow.keras.optimizers import RMSprop
from matplotlib import scale
from sklearn.metrics import confusion_matrix
from keras.utils import np_utils
from keras.preprocessing.image import load_img, img_to_array,array_to_img,ImageDataGenerator, image
from tensorflow.keras.optimizers import RMSprop, SGD
import os
from keras.models import load_model

from sklearn import preprocessing
from sklearn.preprocessing import OneHotEncoder, LabelEncoder

#
animal = ['Cat','Chicken','Cow','Dog','Horse', 'Sheep'] 

dir_train = '/content/drive/MyDrive/data/Upload/Train_set' 
dir_test = '/content/drive/MyDrive/data/Upload/Test_set'

listpath = []
x_train = []
y_train = []
x_test = []
y_test = []

#
size_img=48

def create_data(dir, x_train, y_train):
  for i in animal:
    path = os.path.join(dir,i)
    index_label = animal.index(i)
    for j in os.listdir(path):
      img_path = os.path.join(path, j)
      img = image.load_img(img_path, target_size=(int(size_img), int(size_img)))
      img = img_to_array(img)
      img = img.reshape(int(size_img), int(size_img), 3) 
      img = img.astype('float32')
      img = img/255
      x_train.append(img) #Data
      y_train.append(index_label)

create_data(dir_train, x_train, y_train) #tạo dữ liệu 
create_data(dir_test, x_test, y_test)

# xử lí dữ liệu
x_train = np.array(x_train)
y_train = np.array(y_train)
y_train = np_utils.to_categorical(y_train, 6)
print(x_train.shape)
print(y_train.shape)

x_test = np.array(x_test)
y_test = np.array(y_test)
y_test = np_utils.to_categorical(y_test, 6)
print(x_test.shape)
print(y_test.shape)
